# 首先测试一个IP地址的匹配情况
index="*int_firewall_palo_traffic" (dvc_name=GAEQUXATIFWO1 OR dvc_name=GAEQUXATIFWO2 OR dvc_name=GAEQUXATIFWO3 OR dvc_name=GAEQUXATIFWO4) (src_translated_ip != "0.0.0.0")
| head 1
| append [| inputlookup MS_IP.csv]
| eval is_subnet=if(cidrmatch(subnet, "52.96.90.34"), 1, 0)
| table subnet, is_subnet

# 如果上面测试正常，使用这个扩展测试
index="*int_firewall_palo_traffic" (dvc_name=GAEQUXATIFWO1 OR dvc_name=GAEQUXATIFWO2 OR dvc_name=GAEQUXATIFWO3 OR dvc_name=GAEQUXATIFWO4) (src_translated_ip != "0.0.0.0")
| head 10
| append [| inputlookup MS_IP.csv]
| eval test_result=if(type="subnet", if(cidrmatch(subnet, dest_ip), "Match: " . subnet, "No match"), null())
| stats values(test_result) as matched_subnets by dest_ip
| where matched_subnets!="No match"
